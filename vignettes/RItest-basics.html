<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Gustavo Diaz, University of Illinois at Urbana-Champaign" />

<meta name="date" content="2018-07-16" />

<title>Randomization Inference with RItools</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Randomization Inference with RItools</h1>
<h4 class="author"><em>Gustavo Diaz, University of Illinois at Urbana-Champaign</em></h4>
<h4 class="date"><em>2018-07-16</em></h4>



<p>The <code>RItools</code> package contains helpful functions to conduct randomization inference. Randomization inference is a procedure to tests hypothesis in randomized experiments. Because we know how the experiment was conducted, we can simulate multiple replications and compute the probability of observing values more extreme than an observed test statistic of choice in a world where the null hypothesis is true.</p>
<div id="basics" class="section level2">
<h2>Basics</h2>
<p>After installing, we load the package using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RItools)</code></pre></div>
<p>The <code>nuclearplants</code> data set relates to the construction of ligh water reactor (LWR) plants in the U.S.A. in the late 1960’s and early 1970’s. We want to know if the previous existence of LWR plants at the same site (<code>pr</code>) affects the construction cost of a new plant. See the <code>RItools</code> documentation for further information.</p>
<p>First, we attach and visualize the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;nuclearplants&quot;</span>)

<span class="kw">head</span>(nuclearplants)
<span class="co">#&gt;     cost  date t1 t2  cap pr ne ct bw cum.n pt</span>
<span class="co">#&gt; H 460.05 68.58 14 46  687  0  1  0  0    14  0</span>
<span class="co">#&gt; I 452.99 67.33 10 73 1065  0  0  1  0     1  0</span>
<span class="co">#&gt; A 443.22 67.33 10 85 1065  1  0  1  0     1  0</span>
<span class="co">#&gt; J 652.32 68.00 11 67 1065  0  1  1  0    12  0</span>
<span class="co">#&gt; B 642.23 68.00 11 78 1065  1  1  1  0    12  0</span>
<span class="co">#&gt; K 345.39 67.92 13 51  514  0  1  1  0     3  0</span></code></pre></div>
<p>We use the <code>RItest</code> function to conduct a t-test for difference in means. In its simplest form, we must specify the outcome variable <code>y</code>, treatment indicator <code>z</code>, and the test statistic of choice <code>test.stat</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$pr,
                     <span class="dt">test.stat =</span> t.mean.difference)
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$pr, test.stat = t.mean.difference) </span>
<span class="co">#&gt;       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                           Value Pr(&gt;x)</span>
<span class="co">#&gt; Observed Test Statistic -0.5625 0.7144</span></code></pre></div>
<p><code>RItest</code> outputs the observed test statistic and a p-value. In this case, we have strong evidence in favor of the sharp null of no effect (we would observe this value in such world about 70% of the time).</p>
<div id="test-statistics" class="section level3">
<h3>Test Statistics</h3>
<p><code>RItools</code> contains several useful test statistics that researchers may prefer to use. For example, instead of the difference in means test, we may prefer to compute the difference in a given quantile. We can do this with the <code>quantileDifference()</code> test statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$pr, 
       <span class="dt">test.stat =</span> <span class="kw">quantileDifference</span>(.<span class="dv">25</span>))
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$pr, test.stat = quantileDifference(0.25)) </span>
<span class="co">#&gt;       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                           Value Pr(&gt;x)</span>
<span class="co">#&gt; Observed Test Statistic -64.015 0.8096</span></code></pre></div>
<p>Note that here <code>RItest</code> expects you to include additional details in the test statistic argument. In this case, the function expect us to specify which quantile we are interested in. In the previous case we were interested in the 25th percentile, we can also explore the median difference.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$pr, 
       <span class="dt">test.stat =</span> <span class="kw">quantileDifference</span>(.<span class="dv">50</span>))
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$pr, test.stat = quantileDifference(0.5)) </span>
<span class="co">#&gt;       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Value Pr(&gt;x)</span>
<span class="co">#&gt; Observed Test Statistic 12.015 0.4356</span></code></pre></div>
<p>More generally, we may be interested in comparing the distributions of treatment and control group using the Kolmogorov-Smirnov test statistic. In this case, the null hypothesis is that both distributions have a similar ECDF.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$pr, <span class="dt">test.stat =</span> ksTestStatistic)
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$pr, test.stat = ksTestStatistic) </span>
<span class="co">#&gt;       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                          Value Pr(&gt;x)</span>
<span class="co">#&gt; Observed Test Statistic 0.2182 0.8084</span></code></pre></div>
<p>These are just a few examples of the basic implementation of <code>RItools</code>. The package supports many common test statistics used to analyze experimental data, see the documentation for more details.</p>
<p>A separate vignette also shows how to incorporate custom test statistics.</p>
</div>
<div id="number-of-permutations" class="section level3">
<h3>Number of Permutations</h3>
<p><code>RItest</code> computes test statistics using direct permutation. By default, it performs 5000 replications. This can be changed in the <code>samples</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$pr, <span class="dt">test.stat =</span> t.mean.difference,
       <span class="dt">samples =</span> <span class="dv">100</span>)
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$pr, test.stat = t.mean.difference,  </span>
<span class="co">#&gt;           samples = 100)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                           Value Pr(&gt;x)</span>
<span class="co">#&gt; Observed Test Statistic -0.5625   0.71</span></code></pre></div>
<p>More replications produce more accurate results, but take more time to compute. As a rule of thumb, the default number in <code>samples</code> is good enough and performs reasonably fast in most applications.</p>
</div>
</div>
<div id="complex-design-features" class="section level2">
<h2>Complex Design Features</h2>
<p>The <code>RItest</code> function can also accommodate designs more complex than simple randomization.</p>
<div id="blocked-design" class="section level3">
<h3>Blocked Design</h3>
<p>The <code>sampler</code> argument in <code>RItest</code> allows us to incorporate complex designs by specifying treatment assignment probabilities for observations in the study. By default, <code>sampler</code> uses the <code>simpleRandomSampler</code> function to reproduce a complete randomized design. We can use the same function to accomodate for a blocked design.</p>
<p>First, we specify the design. The <code>simpleRandomSampler</code> function requires us to specify the following arguments:</p>
<ol style="list-style-type: decimal">
<li>The <code>total</code> size of the experimental pool</li>
<li>The total number of <code>treated</code> units</li>
<li>Treatment indicator <code>z</code></li>
<li>Block membership indicator <code>b</code></li>
</ol>
<p>One of <code>treated</code> or <code>z</code> is required. In our current working example, we can imagine that previous LWR were blocked randomized by region. The <code>ne</code> variable captures whether the plant is located in the north-east or somewhere else. We reproduce such a design with the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">region.blocks &lt;-<span class="st"> </span><span class="kw">simpleRandomSampler</span>(<span class="dt">total =</span> <span class="dv">32</span>, <span class="dt">z =</span> nuclearplants$pr,
                                     <span class="dt">b =</span> nuclearplants$ne)</code></pre></div>
<p>Then we can just use <code>RItest</code> as usual, now including our blocked design:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$pr, <span class="dt">test.stat =</span> t.mean.difference,
       <span class="dt">sampler =</span> region.blocks)
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$pr, test.stat = t.mean.difference,  </span>
<span class="co">#&gt;           sampler = region.blocks)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                           Value Pr(&gt;x)</span>
<span class="co">#&gt; Observed Test Statistic -0.5625  0.771</span></code></pre></div>
</div>
<div id="clustered-design" class="section level3">
<h3>Clustered Design</h3>
<p>Similarly, the <code>clusterRandomSampler</code> function reproduces a design in which treatments are assigned to clusters or groups of observations, but administered to individual units within. This function requires us to specify a vector indicating the cluster membership of each observation, <code>clusters</code>, and a treatment assignment vector <code>z</code>.</p>
<p>For the sake of illustration, we simulate a clustered treatment assignment in the <code>nuclearplants</code> data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">20180620</span>)

nuclearplants$cl &lt;-<span class="st"> </span><span class="kw">sample</span>(letters[<span class="dv">1</span>:<span class="dv">3</span>], <span class="dv">32</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)

nuclearplants$trt &lt;-<span class="st"> </span><span class="kw">with</span>(nuclearplants,
                          <span class="kw">ifelse</span>(cl ==<span class="st"> </span><span class="kw">sample</span>(letters[<span class="dv">1</span>:<span class="dv">3</span>], <span class="dv">1</span>), <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<p>This produces three clusters and randomly assigns the observations in one of them to treatment:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(nuclearplants, <span class="kw">table</span>(trt, cl))
<span class="co">#&gt;    cl</span>
<span class="co">#&gt; trt  a  b  c</span>
<span class="co">#&gt;   0  9 12  0</span>
<span class="co">#&gt;   1  0  0 11</span></code></pre></div>
<p>As with blocked designs, the first step is to create an object specifying our clustered design:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim.clusters &lt;-<span class="st"> </span><span class="kw">clusterRandomSampler</span>(<span class="dt">clusters =</span> nuclearplants$cl,
                                     <span class="dt">z =</span> nuclearplants$trt)</code></pre></div>
<p>Then we pass this object to the <code>sampler</code> argument in <code>RItest</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">RItest</span>(nuclearplants$cost, nuclearplants$trt, <span class="dt">test.stat =</span> t.mean.difference,
       <span class="dt">sampler =</span> sim.clusters)
<span class="co">#&gt; Call:  RItest(y = nuclearplants$cost, z = nuclearplants$trt, test.stat = t.mean.difference,  </span>
<span class="co">#&gt;           sampler = sim.clusters)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                         Value    Pr(&gt;x)    </span>
<span class="co">#&gt; Observed Test Statistic 0.702 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
